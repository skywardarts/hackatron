<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, maximum-scale=1, initial-scale=1, user-scalable=0" name="viewport" />
    <meta content="Hackatron, non-stop deathmatch action!" name="description" />

    <title>Hackatron</title>

    <link href="Assets/Other/Styles/Application.css" media="screen" rel="stylesheet" type="text/css" />

    <script src="/socket.io/socket.io.js"></script>

    <script type="text/javascript">
        WebFontConfig = {
            google: { families: ['Orbitron:400,900:latin', 'Montserrat:400,700:latin', 'Press Start 2P:400:latin'] }
        };
        (function() {
            var wf = document.createElement('script');
            wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
            wf.type = 'text/javascript';
            wf.async = 'true';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(wf, s);
        })();
    </script>
  </head>
  <body>
    <div id="game"></div>
    <div id="ui"></div>

    <script src="Assets/Vendor/react.js"></script>
    <script src="Assets/Vendor/react-dom.js"></script>

    <script src="Assets/Vendor/easystar-0.1.7.min.js"></script>
    <script src="Assets/Vendor/pixi.js"></script>
    <script src="Assets/Vendor/phaser-arcade-physics.js"></script>
    <script src="Assets/Vendor/phaser-tiled.js"></script>
    <script src="Assets/Vendor/phaser-debug.js"></script>
    <script src="Assets/Vendor/phaser-camera-shake.js"></script>
    <script src="Assets/Vendor/babel-browser.js"></script>

    <script src="Game/Core/Utils.js"></script>
    <script src="Game/Core/GameObject.js"></script>
    <script src="Game/Core/GamePlugin.js"></script>
    <script src="Game/Core/AI.js"></script>

    <script src="Game/Objects/Map2D.js"></script>
    <script src="Game/Objects/Powerup.js"></script>
    <script src="Game/Objects/Character.js"></script>
    <script src="Game/Objects/Countdown.js"></script>
    <script src="Game/Objects/Gameover.js"></script>
    <script src="Game/Objects/Ghost.js"></script>
    <script src="Game/Objects/Pellet.js"></script>
    <script src="Game/Objects/Tron.js"></script>
    <script src="Game/Objects/Player.js"></script>
    <script src="Game/Objects/Enemy.js"></script>

    <script src='Game/States/Boot.js'></script>
    <script src='Game/States/Preload.js'></script>
    <script src="Game/States/Menu.js"></script>
    <script src="Game/States/Game.js"></script>

    <script src="UI/UI.js" type="text/babel"></script>
    <script src="UI/Screens/StartScreen.js" type="text/babel"></script>
    <script src="UI/Screens/IngameScreen.js" type="text/babel"></script>

    <script type="text/babel">
        ReactDOM.render(<UI />, document.getElementById('ui'));
    </script>

    <script type="text/javascript">
        Hackatron.GAME_WIDTH = 512; // Game originally designed for 256px
        Hackatron.GAME_HEIGHT = 512; // Game originally designed for 256px
        Hackatron.UI_WIDTH = 700; // UI originally designed for 700px
        Hackatron.UI_HEIGHT = 700; // UI originally designed for 700px
        Hackatron.TILE_COUNT_HORIZONTAL = 32;
        Hackatron.TILE_COUNT_VERTICAL = 32;

        var gameContainer = document.getElementById('game');
        var uiContainer = document.getElementById('ui');

        Hackatron.getWidthGameScale = function() {
          return (window.innerWidth / Hackatron.GAME_WIDTH).toFixed(2);
        };

        Hackatron.getHeightGameScale = function() {
          return (window.innerHeight / Hackatron.GAME_HEIGHT).toFixed(2);
        };

        Hackatron.getWidthRatioScale = function() {
          return window.innerHeight > window.innerWidth ? 1 : (window.innerHeight / window.innerWidth).toFixed(2);
        };

        Hackatron.getHeightRatioScale = function() {
          return window.innerHeight > window.innerWidth ? (window.innerWidth / window.innerHeight).toFixed(2) : 1;
        };

        // Resize UI
        window.onresize = function() {
          var smallest = window.innerHeight > window.innerWidth ? gameContainer.offsetWidth / Hackatron.UI_WIDTH : gameContainer.offsetHeight / Hackatron.UI_HEIGHT;
          uiContainer.style.left = (100 - parseInt(gameContainer.style.width)) / 2 + '%';
          uiContainer.style.zoom = smallest;
        };

        // Load Game
        window.onload = function () {
            Hackatron.debug = window.location.href.indexOf('localhost') !== -1;
            Hackatron.loader = new Phaser.Game(Hackatron.GAME_WIDTH, Hackatron.GAME_HEIGHT, Phaser.AUTO, gameContainer, null, true);

            // Game Constants
            DEFAULT_PLAYER_SPEED = 200;
            POWERUP_SPAWN_INTERVAL = 5000;
            UPDATE_INTERVAL = 100;

            Hackatron.loader.state.add('Boot', Hackatron.Boot);
            Hackatron.loader.state.add('Preload', Hackatron.Preload);
            Hackatron.loader.state.add('Menu', Hackatron.Menu);
            Hackatron.loader.state.add('Game', Hackatron.Game);

            Hackatron.loader.state.start('Boot');

            window.onresize();
        };
    </script>
  </body>
</html>
